<!DOCTYPE html>
<html>
    <head><!--- Header --->
        <title>Projeler</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/async/2.0.1/async.min.js"></script>
        <!--Webix-->
        <link rel="stylesheet" href="/webix/codebase/skins/compact.css" type="text/css" charset="utf-8">
        <script src="/webix/codebase/webix.js" type="text/javascript" charset="utf-8"></script>
        <!--Moment-->
        <script src="/moment/moment.js"></script>
        <script src="/moment/locale/tr.js"></script>
        <script src="/moment-timezone/moment-timezone.js"></script>

    </head>

    <style><!--- Style --->
    </style>

    <body><!--- Body --->		
        <script type="text/javascript" charset="utf-8">
            /*=====================================================
				Configuration
			=====================================================*/

            /*--------------------------------------------------------------
                Configuration: MomentJS Locale
            --------------------------------------------------------------*/
            moment.locale("tr")

            webix.ready(function(){

                var projelerT = {
                    id:"projelerT",
                    view:"tree",
                    url: "/projeler?itype=data",
                    on:{
                        "onBeforeOpen":function(id){this.closeAll()},
                        "onSelectChange":function(id){
                            $$("gitlogDT").clearAll()
                            if($$("projelerT").getParentId($$("projelerT").getSelectedId())==0){
                                $$("gitlogDT").load("/projeler/gitlog?projeler="+this.getSelectedItem().value)
                            }
                            else{
                                var projeler = $$("projelerT").getItem($$("projelerT").getParentId($$("projelerT").getSelectedId())).value
                                $$("gitlogDT").load("/projeler/gitlog?projeler="+projeler,function(){
                                    $$("gitlogDT").filter(function(obj){
                                        return obj.subject.toString().indexOf($$("projelerT").getSelectedItem().value+":") != -1;
                                    });
                                })
                            }
                        }
                    },
                    select:true,
                    navigation:true,
                }

                var gitlogDT = {
                    id:"gitlogDT",
                    view:"datatable",
                    columns:[
                        {id:"subject",fillspace:1},
                        {id:"authorDateRel",width:160},
                    ],
                    navigation:true,
                    height:120,
                    header:false,
                    scrollX:false,
                }

                var gitlogBar = {
                    view:"toolbar",
                    cols:[{view:"label", label:"Değişiklik Kaydı", width:200, align:"left" }]
                };

                webix.ui({
                    view:"layout",
                    cols:[
                        {rows:[projelerT,gitlogBar,gitlogDT]},
                    ]
                });
            });
        </script>
    </body>
</html>																														
